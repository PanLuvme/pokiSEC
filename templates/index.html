<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>pokiSEC Loader</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #333446;
            --text-color: #ffffff;
            --accent-color: #61afef;
            --border-color: #6c7086;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .dropzone {
            width: 400px;
            height: 250px;
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            color: #a5b0c5;
        }

        .dropzone:hover {
            border-color: var(--accent-color);
            background: rgba(255, 255, 255, 0.03);
            color: var(--text-color);
        }

        h1 { margin-bottom: 30px; letter-spacing: -1px; }
        .icon { font-size: 3rem; margin-bottom: 15px; }
        #status { margin-top: 20px; color: var(--accent-color); font-size: 0.9rem; }
    </style>
</head>
<body>

    <h1>pokiSEC LOADER</h1>

    <div id="drop-zone" class="dropzone" onclick="document.getElementById('file-input').click()">
        <div class="icon">ðŸ’¿</div>
        <span>DROP QCOW2 HERE</span>
        <input type="file" id="file-input" hidden accept=".qcow2">
    </div>

    <p id="status"></p>

    <script>
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');

        fileInput.addEventListener('change', (e) => uploadFile(e.target.files[0]));

        dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.style.borderColor = '#61afef'; });
        dropZone.addEventListener('dragleave', () => { dropZone.style.borderColor = '#6c7086'; });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadFile(e.dataTransfer.files[0]);
        });

        function uploadFile(file) {
            if (!file) return;
            document.getElementById('status').innerText = "UPLOADING: " + file.name + "...";
            
            const formData = new FormData();
            formData.append('file', file);

            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/upload', true);
            
            xhr.onload = () => {
                if (xhr.status === 200) {
                    document.getElementById('status').innerText = "SUCCESS. STARTING VM...";
                    setTimeout(() => window.location.reload(), 3000);
                }
            };
            xhr.send(formData);
        }
    </script>
</body>
</html>
